

# 🤖 数据集自动构建工具

[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)
[![Version](https://img.shields.io/badge/version-v1.0.0-green.svg)](https://github.com/HIT-Kwoo/KwooLa)
[![Python](https://img.shields.io/badge/python-3.8%2B-blue.svg)](https://www.python.org/)

> 一个基于大模型的全流程数据集构建工具，从数据获取、处理到知识结构化，实现高效、灵活、可定制的数据生产流水线。

> 🌟 **KwooLa 完整项目**，请访问主仓库：[https://github.com/HIT-Kwoo/KwooLa/tree/main](https://github.com/HIT-Kwoo/KwooLa/tree/main)

## 📝 概述

这是一个基于大模型的数据集自动构建工具，提供从数据获取、处理到知识结构化及可训练数据生成的完整数据处理流水线。该工具支持文本数据处理、问答对生成、图文对齐处理和知识图谱构建等功能。整个系统支持关键组件的灵活配置与流程中断点续跑，提升了资源利用效率，可兼容绝大多数主流模型API及具有格式化输出能力的本地模型。

## ✨ 功能特性

-   🔑 **关键词生成与扩展**：基于主题和方面自动生成相关关键词。
-   🌐 **数据爬取与预处理**：使用官方搜索API自动爬取网络数据并进行清洗预处理。
-   🧠 **知识点提取**：从文本中提取结构化知识点，并迭代式补全缺少的知识。
-   💬 **问答对生成**：生成单知识点和多知识点问答对。
-   🖼️ **图文对齐处理**：图片去重、过滤和描述生成。
-   🕸️ **知识图谱构建**：自动构建领域知识图谱。

## 🚀 快速开始

运行以下命令，以交互模式启动工具包服务：

```bash
.\dataset_builder.exe --interactive
```

## ⚙️ 全局配置

在 `dataset_builder.exe` 文件同级目录下，您会找到 `config.json` 文件。请根据您的需求修改此文件。

```json
{
  // 系统路径配置
  "os_path": "/path/to/your/workspace", // 系统基础工作路径

  // 模型调用配置 (支持 API 和 local 模式)
  "model_config": {
    "api": {
      "base_url": "https://api.example.com/v1", // API 基础 URL
      "api_key": "YOUR_API_KEY",               // API 访问密钥
      "model": "gpt-5"                   // 使用的模型名称
    },
    "local": {
      "device": "cuda",                        // 运行设备 (cpu/cuda)
      "cuda_visible_devices": "0",             // GPU 设备编号
      "model_path": "/path/to/your/model"      // 本地模型路径
    }
  },

  // 搜索API设置
  "search_api_config": {
    "search_url": "https://aip.baidubce.com/rpc/2.0/creation/v1/search/universal", // 搜索API服务商URL
    "search_api": "YOUR_SEARCH_API_KEY"                                           // 搜索API密钥
  }
}
```

**注意**：您可以在程序的交互过程中随时切换 `API模式` 和 `本地模型模式`。

## 📖 使用指南

### 主菜单

运行程序后，系统将显示主菜单，提供以下核心功能：

```text
请选择操作：
1. 初始化配置
2. 生成关键词
3. 执行完整流程
4. 查看配置
5. 帮助
0. 退出
```

---

### 1. 初始化配置

**功能**：配置系统参数和模型设置，为后续处理流程提供基础配置。

**交互流程示例**：

```text
当前配置 ---
数据存储路径：/path/to/your/workspace
模式    : api
API BaseURL ：https://api.example.com/v1
API Key    : sk-*****
模型名    : gpt-5
排除词    : ["广告", "推广"]

请选择：
[1] 修改数据存储路径
[2] 切换模式 api/local
[3] 编辑 API 配置
[4] 编辑排除词
[5] 保存并退出
[6] 放弃并退出
```

---

### 2. 生成关键词

**功能**：根据输入的主关键词和背景描述，生成相关的关键词列表和模式框架。

**交互流程示例**：

```text
请输入主关键词(如:棉花)：
> 棉花种植

请输入背景描述(如:棉花品种信息)：
> 关于棉花种植全周期的病虫害防治知识

生成关键词: ["农药使用规定", "农药残留注意事项", "农药定量施用指导", "农业农药安全", "农药分类与用途", "如何选择合适的农药", "农作物病虫害防治"]
生成模式: ["农药类型", "使用浓度", "适用作物", "施用方法", "施用时间", "注意事项", "农药残留检测"]
```

---

### 3. 执行完整流程

**功能**：执行完整的数据集构建流水线，支持选择性执行特定步骤，也支持中断点续跑。

**交互流程示例**：

```text
开始处理流程（输入 quit 随时退出整个流程）
步骤清单：
1. 数据获取与处理
2. 单知识点问答生成
3. 多知识点问答生成
4. 图文对齐生成
5. 知识图谱生成
6. 数据统计

请输入要执行的步骤编号（例：1 3 5 或 1-4,6）：
> 1-3 6
```

#### **流水线步骤详解**

-   **1. 数据获取与处理** 📥
    -   **收集**：网络数据收集
    -   **清洗**：文本数据预处理和清洗
    -   **生成**：知识点生成与质量评估
    -   **补全**：迭代式知识补全

-   **2. 单知识点问答生成** 💬
    -   基于单个知识点生成简单的问答对。

-   **3. 多知识点问答生成** 🧠
    -   整合多个相关知识点，建立关联，生成需要多步推理的复杂问答对。

-   **4. 图文对齐生成** 🖼️
    -   **过滤**：图片去重和质量过滤
    -   **对齐**：建立图文对应关系
    -   **描述**：为图片生成描述文本

-   **5. 知识图谱生成** 🕸️
    -   **抽取**：从文本中抽取实体和关系
    -   **去重**：进行全局式实体/关系去重
    -   **构建**：构建结构化知识图谱

-   **6. 数据统计** 📊
    -   统计数据集规模，并生成可视化数据报告。

---

### 4. 查看配置

**功能**：显示当前系统的所有配置参数，方便您随时检查。

### 5. 帮助

**功能**：提供系统使用说明和各功能模块的详细解释。

### 0. 退出

**功能**：安全退出数据集构建工具。

## 🔧 技术亮点

-   ✅ **模块化设计**：每个处理步骤独立可配置，支持灵活的工作流组合。
-   🎮 **交互式操作**：提供友好的命令行交互界面，操作简单直观。
-   🔄 **多模式支持**：支持 API 调用和本地模型两种运行模式，灵活切换。
-   🛡️ **质量保障**：内置多重质量检查和过滤机制，确保数据质量。
-   🧩 **扩展性强**：支持自定义关键词、模式和数据处理流程。

## ⚠️ 注意事项

-   **环境依赖**：确保所有相关依赖函数已正确实现和导入。
-   **路径配置**：首次使用前，请务必在 `config.json` 中正确配置 `os_path` 全局变量。
-   **模型初始化**：首次使用需要通过 `初始化配置` 功能来设置模型参数。
-   **存储空间**：请确保有足够的磁盘空间存储生成的数据集。
-   **网络连接**：数据爬取功能需要稳定的网络连接。